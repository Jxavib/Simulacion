---
title: "Taller MonteCarlo"
author: "Beltran Henry, Burbano Joel,Guaman Ronny"
date: "27/7/2021"
output: html_document
---

# Ejercicios de fin de práctica

***6. Aproximar mediante simulación la integral: $$\int_{-1}^1 \frac{1}{8}(5-3x^2)dx$$***

a) ***Emplear integración Monte-Carlo clásica (distribución uniforme) y representar graficamente la aproximación en función de $n(1\leq n\leq 1000)$.***

```{r}
# Desarrollo del literal a)
#Implementacion  monte carlo
mc.integral0 <- function(fun,a,b,n){
  x <- runif(n,a,b)
  fx <- sapply(x,fun)
  return(mean(fx)*(b-a))
}

#Funcion a integrar

fun <- function(x) ifelse((-1<x &x<1),0.125*(5-3*x^2),0)

# Representación grafica

curve(fun,-1,1)
abline(h=0,lty=2)
abline(v=c(-1,1),lty=2)

#Realizar la intengracion en dependencia de n
mc.integraln <- function(n=1000){
  x <- numeric()
  for( i in 1:n ){
    set.seed(1)
    x[i] <- mc.integral0(fun,-1,1,i)
  }
  return(x)
}
n=1000
y <- mc.integraln(n)
y <- cbind(1:n,y)
head(y,20)
```

b) ***Compara los resultados del apartado anterior con los obtenidos empleando muestreo de importancia con distribución auxiliar $N(0,0.3)$, ¿Se produce una reducción de la varianza?***

```{r}
#Desarrollo del literal b)


```

c) ***Generar 100 simulaciones de la distribución (aprox) con densidad $f(x)=\frac{1}{8}(5-3x^2)$ si $-1<x<1$ mediante remuestreo del muestro por importancia de 1000 valores de una $N(0,0.3)$***

```{r}
#Desarrolllo del literal c)

```

